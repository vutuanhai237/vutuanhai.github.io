---
layout: post
title: "Crypto #5: Kho báu Beale"
categories: cryptography
link: https://vutuanhai237.github.io/cryptography/2021/03/16/crypto-5.html
---
### **Người đàn ông bí ẩn**

Câu chuyện bắt đầu ở khách sạn Washington ở Lynchburg, Virginia với người chủ khách sạn tên là Robert Morriss, một người được đánh giá rất cao với tính tình tử tế, chân thật và nghiêm túc. Nhờ tài quản lý và cắt đặt công việc hợp lý, khách sạn của ông đã nhanh chóng nổi tiếng và lan sang những bang khác. Khách sạn của ông là một ngôi nhà đặc biệt và luôn có những cuộc hội họp sang trọng được tổ chức. 

Đầu năm 1820, một người lạ mặt có tên là Thomas J. Beale cưỡi ngựa đến và nghỉ tại khách sạn Washington. Ông ta đã nghỉ trong toàn bộ phần còn lại của mùa đông và cực kì thân thiện với tất cả mọi người, đặc biệt là các quý bà, song ông lại không bao giờ nói về thân thế của mình, gia đình hay mục đích chuyến đi của ông. Sau đó đến cuối tháng 3, ông ra đi đột ngột hệt như lúc đến.

Khoảng 2 năm sau, Beale trở lại khách sạn. Một lần nữa, ông dành phần còn lại của mùa đông ở Lynchburg và lại biến mất vào mùa xuân. Nhưng trước khi ra đi, ông đã tin cậy giao cho Morriss - như một người bạn thân, một chiếc hộp sắt khóa kín và nói rằng trong đó chứa vài giấy tờ rất có giá trị. Morriss cất chiếc hộp và không quan tâm đến nó nữa. Cho đến ngày 9/5/1822, ông nhận được lá thư gửi từ St. Louis, tiết lộ bí mật quan trọng về chiếc hộp, Beale giải thích rằng:
"Nó chứa đựng những giấy tờ liên quan đến tài sản của bản thân tôi và rất nhiều người khác cùng làm ăn với tôi, trong trường hợp tôi chết thì sự biến mất của nó sẽ xảy ra. Vì vậy, chắc ông cũng hiểu sự cần thiết cho việc ngăn thảm họa khủng khiếp đó. Có thể không ai trong chúng tôi trở lại, nên ông làm ơn bảo vệ chiếc hộp trong khoảng thời gian 10 năm kể từ ngày ghi trên lá thư này, nếu trong khoảng thời gian đó tôi hoặc ai đó được tôi ủy quyền không đến lấy thì ông hãy mở nó. Ông sẽ thấy một số giấy tờ đề gửi ông, một số khác thi ông không thể đọc được nếu không có chìa khóa. Chìa khóa đó tôi đã trao tận tay cho một người bạn, đã niêm phong và đề gửi ông, đồng thời được đảm bảo ông sẽ nhận được vào tháng 6 năm 1832. Bằng chìa khóa này, ông sẽ hiểu được tất cả những gì phải làm."

Morriss đã thực hiện nhiệm vụ đầy trách nhiệm và chờ Beale hay người được ủy thác đến lấy, tuy nhiên người đàn ông ấy đã không bao giờ trở lại Lynchburg nữa. 10 năm sau, Morriss lẽ ra đã có thể làm theo chỉ dẫn của lá thư nhưng khóa mã mà Beale nhắc tới cũng không được giao vào tháng 6, do đó ông nghĩ rằng mở nó ra cũng sẽ chẳng có ích lợi gì. Cuối cùng, năm 1845, sự tò mò đã chiến thắng và Morriss phá khóa.

### **Có gì bên trong chiếc hộp sắt?**

Morriss tìm được 3 tờ giấy đã được mã hóa và một bức thư viết bằng tiếng Anh thông thường.

![](https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/d9aa5e80a92711e8afe3855800c5ddad.jpg)

Bức thư tiết lộ sự thật về Brale và những bản mã. Nó giải thích rằng vào tháng 4 năm 1817, Beale và 29 người khác thực hiện hành trình xuyên nước Mỹ. Sau khi thăm thú những vùng đất săn bắn giàu có, họ đã đến Santa Fe, và sống ở một thị trấn Mehico suốt mùa đông. Sau đó họ tiến lên phía bắc,bắt đầu đi săn bò rừng và hạ gục được rất nhiều con dọc chuyến đi. Sau đó, họ đã gặp may: "Một ngày, khi hạ trại tại một khe núi, một người trong bọn tôi đã phát hiện ra dấu viết của vàng trong khe nứt của tảng đá. Sau khi đưa người khác xem thì được xác nhận đúng là vàng, và kết quả là tất cả đều cực kì phấn khích".

Tiếp đó bức thư giải thích Beale cùng bạn bè và một bộ lạc địa phương đã khai thác cả vùng trong 18 tháng, họ đã có một kho báu bao gồm vàng và bạc rất lớn. Họ thống nhất rằng kho báu phải được chuyển đến một nơi an toàn và họ đã quyết định chọn một địa điểm bí mật tại quê nhà Virginia. Năm 1820, Beale đến Lynchburg cùng kho báu để cất giấu. Đó là dịp ông trú tại khách sạn Washington và làm quen với Moriss lần đầu tiên. Sau khi hết mùa đông ông cùng bạn bè tiếp tục lên đường để khai thác. Sau đó 18 tháng nữa, Beale trở lại để bổ sung thêm vào kho báu của mình. Lần này có thêm lý do nữa, nhóm Beale được khuyên là do kho báu quá bí mật nên đề phòng trường hợp họ chết, phải có một người đáng tin tưởng để làm nhiệm vụ phân chia kho báu cho người thân của những thành viên trong nhóm. Chính vậy, Beale đã tin tưởng giao nhiệm vụ cho Morriss vì biết Morriss là một người liêm chính.
Đoạn cuối bức thư nói về nội dung của 3 bản mã chỉ chứa các con số cách nhau bởi dấu phẩy: bản đầu tiên mô tả vị trí cất kho báu, bản thứ hai liệt kê số lượng kho báu và bản cuối cùng là danh sách những người sẽ nhận được phần chia.

![](https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/64836ef0a91611e88aad4335c39566eb.png)

*Từ trái sang phải: bản mã 2 - 3 - 1*

Morriss nhận thấy trách nhiệm của mình trong việc này, tuy nhiên không có chìa khóa làm mọi nỗ lực giải mã của ông đều chỉ là con số 0. Năm 1862, ở tuổi 84, khi đã gần đất xa trời, Morriss đã giao lại trọng trách cho một người bạn, quyết tâm không để ý nguyện của Beale xuống mồ cùng ông. Tất cả những gì chúng ta biết về người bạn này chỉ là ông ta chính là tác giả viết nên cuốn sách chứa toàn bộ nội dung của bài viết, chúng ta sẽ tạm gọi ông ta là tác giả.

### **Hành trình giải mã chưa từng có hồi kết**

Tác giả đã tóm tắt toàn bộ câu chuyện giữa Beale và Morrissm và những khám phá về 3 bản mật mã của ông trong gói gọn 23 trang sách. Nhận xét về loại một mã của Beale, ông giả định rằng mỗi con số là một ký hiệu cho một chữ cái nào đó, tuy nhiên số lượng số lại gấp nhiều lần số lượng chữ cái khiến ông lo ngại mình đang phải dối đầu với một loại mật mã phức tạp, trong đó nhiều con số sẽ biểu thị cùng một chữ cái. Loại mật mã này có tên gọi là mật mã sách (book cipher) hay mật mã Beale. Chìa khóa để giải mã có thể là một văn bản hoặc một cuốn sách bất kì. 
Đầu tiên người mã hóa đánh số mỗi từ trong văn bản khóa mã, mỗi số sẽ thay thế cho một chữ cái đầu tiên của từ tương ứng. Ví dụ: "(1) hôm (2) nay (3) tôi (4) đã (5) dành (6) ra (7) ba (8) phút (9) để (10) tạo (11) ví (12) dụ (13) này". Sau đó thiết lặp một bảng gắn mỗi số với chữ cái đầu tiên của từ tương ứng:
```
1 = h   8 = p
2 = n   9 = đ
3 = t   10 = t
4 = đ   11 = v
5 = d   12 = d
6 = r   13 = n
7 = b
```
Mỗi bức thư giờ có thể được mã hóa bằng cách thay thế chữ cái thường bằng số các con số trong bảng trên. Chữ d có thể thay bằng 5 hoặc 12, chữ t có thể thay bằng 3 hoặc 10. Vì văn bản trong ví dụ tương đối ngắn nên ta không có đủ số để thay thế toàn bộ các chữ cái khác, Sử dụng bảng trên, ta có thể mã hóa từ http thành dãy 1, 3, 10, 8. Nếu người nhận có văn bản mã khóa thì việc giải mã rất dễ dàng. Tuy nhiên nếu có bên thứ 3 bắt tay vào thì khả năng giải sẽ càng thấp nếu văn bản khóa mã càng dài.

Tác giả cuốn sách đã viết: "Với ý tưởng này, tôi đã thử với tất cả các cuốn sách mà tôi có thể kiếm được, vì hy vọng chỉ sống lại khi Bản Tuyên Ngôn độc lập đã cho tôi đầu mối để giải bản mã thứ 2."

Bản mã thứ 2 nói kho báu được chôn ở hạt Bedford, cách Buford khoảng 4 dặm, trong một cái hố sâu khoảng 1 m. Kho báu bao gồm 2 phần: phần 1 gồm 1014 pound vàng & 3812 pound bạc, phần 2 gồm 1281 pound vàng, 1288 pound bạc và một số đá quý khác đổi từ St. Louis để vận chuyển an toàn hơn. Tổng giá trị kho báu là khoảng 160 triệu đôla nếu tính theo giá vàng hiện nay.

![](https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/e62492f0a92911e89b1d9f62427e324a.jpg)

Sẽ chảng có gì ngạc nhiên khi tác giả nói rằng ông đã lao đầu vào giải 2 bản mã còn lại, đặc biệt là bản mã thứ 1. Tuy đã cố gắng không mệt mỏi lẫn đánh mất cả bản thân nhưng cuối cùng tác giả vẫn thất bại. Ông đã quyết định cắt đứt vĩnh viễn mọi liên hệ với câu chuyện này và chuộc lỗi với Morriss bằng cách cho xuất bản cuốn sách.
Cuốn sách được xuất bản gây ra sự tò mò đối với nhiều người, người thường khi nhìn vào bản mã sẽ thấy cực kì vô vọng. Tuy nhiên đối với những tay thợ săn kho báu thì đây lại là một cơ hội để kiếm chác. Trong số những kẻ hăng hái nhất là anh em nhà Hart, George và Clayton, cả 2 nỗ lực trong nhiều năm những kết quả vẫn là con số 0, Clayton bỏ cuộc năm 1912 còn George vẫn tiêp tục 40 năm sau đó. Ngoài ra còn một fan cuồng của Beale là Herbert, ông đã theo đuổi câu chuyện trong suốt 47 năm nhưng tiếc là nỗ lực của ông cũng không được đền đáp. Hiệp hội Kho báu và mật mã Beale cũng được thành lập, những nhà giải mã chuyên nghiệp tham gia tìm kiếm, ... nhưng vàng, bạc, đá quý vẫn chẳng thấy tăm hơi đâu.

### **Lý giải cho tính bất khả thi về 2 bản mật mã còn lại**

Chúng ta có thể rất ngạc nhiên về sức mạnh không thể giải mã nổi của mật mã Beale, trong khi đó một loại mật mã phức tạp hơn là mật mã Vigenère đã được Babbage giải mã nhiều năm trước. Làm sao Beale có thể tạo ra một cơn chấn động cho giới mật mã học như vậy? Câu trả lời là ở khóa mã đặc biệt của ông. Thực tế nếu văn bản chìa khóa là do Beale sáng tác ra thì chúng ta có thể giải thích tại sao không thể tìm ra được chìa khóa mã đúng. Lý do Beale không sử dụng mật mã Vigenère bởi vì tính dễ sai sót của nó, giả sử ông sử dụng cách phân phối khóa này kết hợp với mật mã Vigenère thì không thể tưởng tượng tỉ lệ giải mã 2 bản mã Beale nhỏ đến mức nào.

Một thuyết khác cho rằng tác giả đã cố tình thay đổi 2 bản mã còn lại, buộc người giữ chìa khóa phải liên lạc với tòa soạn rồi liên lạc với ông để 2 bên sẽ cùng có lợi. Cũng có trường hợp kho báu đã được tìm thấy từ nhiều năm trước mà không bị ai bắt gặp. Cuối cùng, chúng ta không thể loại trừ khả năng toàn bộ câu chuyện đều là hư cấu và tác giả đã xuất bản cuốn sách để kiếm lợi từ lòng tham của một số người.

Biết đâu, sau khi đọc xong câu chuyện, bạn cũng nảy ra ham muốn theo đuổi thách thức này, 160 triệu đôla thật khó cưỡng. Tuy nhiên cũng nên nhớ rằng toàn bộ những người đã tham gia đào bới cũng đã có kết quả không tốt đẹp là bao.

*Kết thúc bài 5, bài viết tham khảo cuốn sách Mật mã từ cổ điển đến lượng tử (Simon Singh).*

Bài viết gốc: [Spiderum](https://spiderum.com/bai-dang/Chien-tranh-and-lien-lac-bi-mat-ki-5-Kho-bau-Beale-bp6)

[Crypto #6: Enigma](https://spiderum.com/bai-dang/Chien-tranh-va-lien-lac-bi-mat-ki-6-Enigma-bpt)

<p style="text-align: right">Tác giả</p>

<p style="text-align: right;">
Vũ Tuấn Hải - Monadotory
</p>
